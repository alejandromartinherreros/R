<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es">
<head>
<!-- 2019-05-22 mié 20:23 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Funciones</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Oscar Perpiñán Lamigueiro @@latex:\\@@ http://oscarperpinan.github.io" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="http://www.pirilampo.org/styles/readtheorg/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="http://www.pirilampo.org/styles/readtheorg/css/readtheorg.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/readtheorg/js/readtheorg.js"></script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2018 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Funciones</h1>


<div id="outline-container-orgc810a35" class="outline-2">
<h2 id="orgc810a35"><span class="section-number-2">1</span> Conceptos Básicos</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-org0c57b29" class="outline-3">
<h3 id="org0c57b29"><span class="section-number-3">1.1</span> Fuentes de información</h3>
<div class="outline-text-3" id="text-1-1">
<ul class="org-ul">
<li><a href="http://cran.r-project.org/doc/manuals/R-intro.html">R introduction</a></li>
<li><a href="http://cran.r-project.org/doc/manuals/R-lang.html">R Language Definition</a></li>
<li><a href="http://www.springer.com/gb/book/9780387759357">Software for Data Analysis</a></li>
</ul>
</div>
</div>
<div id="outline-container-orgca4a637" class="outline-3">
<h3 id="orgca4a637"><span class="section-number-3">1.2</span> Componentes de una función</h3>
<div class="outline-text-3" id="text-1-2">
<ul class="org-ul">
<li>Una función se define con <code>function</code></li>
</ul>
<div class="org-center">
<p>
<code>name &lt;- function(arg_1, arg_2, ...) expression</code>
</p>
</div>
<ul class="org-ul">
<li>Está compuesta por:
<ul class="org-ul">
<li>Nombre de la función (<code>name</code>)</li>
<li>Argumentos (<code>arg_1</code>, <code>arg_2</code>, <code>...</code>)</li>
<li>Cuerpo (<code>expression</code>): emplea los argumentos para generar un resultado</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-orgf038aae" class="outline-3">
<h3 id="orgf038aae"><span class="section-number-3">1.3</span> Mi primera función</h3>
<div class="outline-text-3" id="text-1-3">
<ul class="org-ul">
<li>Definición</li>
</ul>
<div class="org-src-container">
<pre class="src src-R"><span class="org-function-name">myFun</span> <span class="org-ess-assignment">&lt;-</span> <span class="org-ess-keyword">function</span>(x, y)
{
    x + y
}
</pre>
</div>

<ul class="org-ul">
<li>Argumentos</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">formals(myFun)
</pre>
</div>

<pre class="example">
$x


$y
</pre>


<ul class="org-ul">
<li>Cuerpo</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">body(myFun)
</pre>
</div>

<pre class="example">
{
    x + y
}
</pre>
</div>
</div>

<div id="outline-container-orgeade927" class="outline-3">
<h3 id="orgeade927"><span class="section-number-3">1.4</span> Mi primera función</h3>
<div class="outline-text-3" id="text-1-4">
<div class="org-src-container">
<pre class="src src-R">myFun(1, 2)
</pre>
</div>

<pre class="example">
[1] 3
</pre>


<div class="org-src-container">
<pre class="src src-R">myFun(1:10, 21:30)
</pre>
</div>

<pre class="example">
[1] 22 24 26 28 30 32 34 36 38 40
</pre>


<div class="org-src-container">
<pre class="src src-R">myFun(1:10, 3)
</pre>
</div>

<pre class="example">
[1]  4  5  6  7  8  9 10 11 12 13
</pre>
</div>
</div>

<div id="outline-container-org27428cf" class="outline-3">
<h3 id="org27428cf"><span class="section-number-3">1.5</span> Argumentos: nombre y orden</h3>
<div class="outline-text-3" id="text-1-5">
<p>
Una función identifica sus argumentos por su nombre y por su orden (sin nombre)
</p>

<div class="org-src-container">
<pre class="src src-R"><span class="org-function-name">power</span> <span class="org-ess-assignment">&lt;-</span> <span class="org-ess-keyword">function</span>(x, exp)
{
    x^exp
}
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R">power(x=1:10, exp=2)
</pre>
</div>

<pre class="example">
[1]   1   4   9  16  25  36  49  64  81 100
</pre>


<div class="org-src-container">
<pre class="src src-R">power(1:10, exp=2)
</pre>
</div>

<pre class="example">
[1]   1   4   9  16  25  36  49  64  81 100
</pre>


<div class="org-src-container">
<pre class="src src-R">power(exp=2, x=1:10)
</pre>
</div>

<pre class="example">
[1]   1   4   9  16  25  36  49  64  81 100
</pre>
</div>
</div>

<div id="outline-container-org232633f" class="outline-3">
<h3 id="org232633f"><span class="section-number-3">1.6</span> Argumentos: valores por defecto</h3>
<div class="outline-text-3" id="text-1-6">
<ul class="org-ul">
<li>Se puede asignar un valor por defecto a los argumentos</li>
</ul>
<div class="org-src-container">
<pre class="src src-R"><span class="org-function-name">power</span> <span class="org-ess-assignment">&lt;-</span> <span class="org-ess-keyword">function</span>(x, exp = 2)
{
    x ^ exp
}
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R">power(1:10)
</pre>
</div>

<pre class="example">
[1]   1   4   9  16  25  36  49  64  81 100
</pre>


<div class="org-src-container">
<pre class="src src-R">power(1:10, 2)
</pre>
</div>

<pre class="example">
[1]   1   4   9  16  25  36  49  64  81 100
</pre>
</div>
</div>

<div id="outline-container-org782776f" class="outline-3">
<h3 id="org782776f"><span class="section-number-3">1.7</span> Funciones sin argumentos</h3>
<div class="outline-text-3" id="text-1-7">
<div class="org-src-container">
<pre class="src src-R"><span class="org-function-name">hello</span> <span class="org-ess-assignment">&lt;-</span> <span class="org-ess-keyword">function</span>()
{
    print(<span class="org-string">'Hello world!'</span>)
}
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R">hello()
</pre>
</div>

<pre class="example">
[1] "Hello world!"
</pre>
</div>
</div>

<div id="outline-container-orgb4d3360" class="outline-3">
<h3 id="orgb4d3360"><span class="section-number-3">1.8</span> Argumentos sin nombre: <code>...</code></h3>
<div class="outline-text-3" id="text-1-8">
<div class="org-src-container">
<pre class="src src-R"><span class="org-function-name">pwrSum</span> <span class="org-ess-assignment">&lt;-</span> <span class="org-ess-keyword">function</span>(x, power, ...)
{
    sum(x ^ power, ...)
}
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R">x <span class="org-ess-assignment">&lt;-</span> 1:10
pwrSum(x, 2)
</pre>
</div>

<pre class="example">
[1] 385
</pre>


<div class="org-src-container">
<pre class="src src-R">x <span class="org-ess-assignment">&lt;-</span> c(1:5, <span class="org-ess-constant">NA</span>, 6:9, <span class="org-ess-constant">NA</span>, 10)
pwrSum(x, 2)
</pre>
</div>

<pre class="example">
[1] NA
</pre>


<div class="org-src-container">
<pre class="src src-R">pwrSum(x, 2, na.rm=<span class="org-ess-constant">TRUE</span>)
</pre>
</div>

<pre class="example">
[1] 385
</pre>
</div>
</div>

<div id="outline-container-orgc0fa848" class="outline-3">
<h3 id="orgc0fa848"><span class="section-number-3">1.9</span> Argumentos ausentes: <code>missing</code></h3>
<div class="outline-text-3" id="text-1-9">
<div class="org-src-container">
<pre class="src src-R"><span class="org-function-name">suma10</span> <span class="org-ess-assignment">&lt;-</span> <span class="org-ess-keyword">function</span>(x, y)
{
    <span class="org-ess-keyword">if</span> (missing(y)) y <span class="org-ess-assignment">&lt;-</span> 10
    x + y
}
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R">suma10(1:10)
</pre>
</div>

<pre class="example">
[1] 11 12 13 14 15 16 17 18 19 20
</pre>
</div>
</div>

<div id="outline-container-org0eebe2c" class="outline-3">
<h3 id="org0eebe2c"><span class="section-number-3">1.10</span> Control de errores: <code>stopifnot</code></h3>
<div class="outline-text-3" id="text-1-10">
<div class="org-src-container">
<pre class="src src-R"><span class="org-function-name">foo</span> <span class="org-ess-assignment">&lt;-</span> <span class="org-ess-keyword">function</span>(x, y)
{
    stopifnot(is.numeric(x) &amp; is.numeric(y))
    x + y
}
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R">foo(1:10, 21:30)
</pre>
</div>

<pre class="example">
[1] 22 24 26 28 30 32 34 36 38 40
</pre>


<div class="org-src-container">
<pre class="src src-R">foo(1:10, <span class="org-string">'a'</span>)
</pre>
</div>

<pre class="example">
Error in foo(1:10, "a") : is.numeric(x) &amp; is.numeric(y) is not TRUE
</pre>
</div>
</div>

<div id="outline-container-orgadfa5c4" class="outline-3">
<h3 id="orgadfa5c4"><span class="section-number-3">1.11</span> Control de errores: <code>stop</code></h3>
<div class="outline-text-3" id="text-1-11">
<div class="org-src-container">
<pre class="src src-R"><span class="org-function-name">foo</span> <span class="org-ess-assignment">&lt;-</span> <span class="org-ess-keyword">function</span>(x, y){
    <span class="org-ess-keyword">if</span> (!(is.numeric(x) &amp; is.numeric(y))){
        <span class="org-ess-keyword">stop</span>(<span class="org-string">'arguments must be numeric.'</span>)
    } <span class="org-ess-keyword">else</span> { x + y }
} 
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R">foo(2, 3)
</pre>
</div>

<pre class="example">
[1] 5
</pre>


<div class="org-src-container">
<pre class="src src-R">foo(2, <span class="org-string">'a'</span>)
</pre>
</div>

<pre class="example">
Error in foo(2, "a") : arguments must be numeric.
</pre>
</div>
</div>

<div id="outline-container-org5adb033" class="outline-3">
<h3 id="org5adb033"><span class="section-number-3">1.12</span> Mensajes para el usuario</h3>
<div class="outline-text-3" id="text-1-12">
<p>
<code>stop</code> para la ejecución y emite un mensaje de error
</p>
<div class="org-src-container">
<pre class="src src-R"><span class="org-ess-keyword">stop</span>(<span class="org-string">'Algo no ha ido bien.'</span>)
</pre>
</div>

<pre class="example">
Error: Algo no ha ido bien.
</pre>


<p>
<code>warning</code> no interfiere en la ejecución pero añade un mensaje a la cola de advertencias
</p>
<div class="org-src-container">
<pre class="src src-R"><span class="org-ess-modifiers">warning</span>(<span class="org-string">'Quiz&#225;s algo no es como debiera...'</span>)
</pre>
</div>

<pre class="example">
Warning message:
Quizás algo no es como debiera...
</pre>


<p>
<code>message</code> emite un mensaje (<b>no usar <code>cat</code> o <code>print</code></b>)
</p>
<div class="org-src-container">
<pre class="src src-R"><span class="org-ess-modifiers">message</span>(<span class="org-string">'Todo en orden por estos lares.'</span>)
</pre>
</div>

<pre class="example">
Todo en orden por estos lares.
</pre>
</div>
</div>
</div>


<div id="outline-container-org7f0bdcb" class="outline-2">
<h2 id="org7f0bdcb"><span class="section-number-2">2</span> Lexical scope</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-org532df08" class="outline-3">
<h3 id="org532df08"><span class="section-number-3">2.1</span> Clases de variables</h3>
<div class="outline-text-3" id="text-2-1">
<p>
Las variables que se emplean en el cuerpo de una función pueden
dividirse en:
</p>
<ul class="org-ul">
<li>Parámetros formales (argumentos): <code>x</code>, <code>y</code></li>
<li>Variables locales (definiciones internas): <code>z</code>, <code>w</code>, <code>m</code></li>
<li>Variables libres: <code>a</code>, <code>b</code></li>
</ul>
<div class="org-src-container">
<pre class="src src-R"><span class="org-function-name">myFun</span> <span class="org-ess-assignment">&lt;-</span> <span class="org-ess-keyword">function</span>(x, y){
    z <span class="org-ess-assignment">&lt;-</span> x^2
    w <span class="org-ess-assignment">&lt;-</span> y^3
    m <span class="org-ess-assignment">&lt;-</span> a*z + b*w
    m
}
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R">a <span class="org-ess-assignment">&lt;-</span> 10
b <span class="org-ess-assignment">&lt;-</span> 20
myFun(2, 3)
</pre>
</div>

<pre class="example">
[1] 580
</pre>
</div>
</div>

<div id="outline-container-org621c9b0" class="outline-3">
<h3 id="org621c9b0"><span class="section-number-3">2.2</span> Lexical scope</h3>
<div class="outline-text-3" id="text-2-2">
<ul class="org-ul">
<li>Las variables libres deben estar disponibles en el entorno
(<code>environment</code>) en el que la función ha sido creada.</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">environment(myFun) 
</pre>
</div>

<pre class="example">
&lt;environment: R_GlobalEnv&gt;
</pre>


<div class="org-src-container">
<pre class="src src-R">ls()
</pre>
</div>

<pre class="example">
 [1] "a"               "anidada"         "b"               "constructor"    
 [5] "diamonds"        "fib"             "foo"             "hello"          
 [9] "i"               "lista"           "ll"              "lmFertEduCatAgr"
[13] "m"               "M"               "makeNoise"       "myFoo"          
[17] "myFun"           "power"           "pwrSum"          "suma1"          
[21] "suma10"          "suma2"           "suma3"           "sumProd"        
[25] "sumSq"           "tmp"             "x"               "zz"
</pre>
</div>
</div>

<div id="outline-container-orgb0d4f12" class="outline-3">
<h3 id="orgb0d4f12"><span class="section-number-3">2.3</span> Lexical scope: funciones anidadas</h3>
<div class="outline-text-3" id="text-2-3">
<div class="org-src-container">
<pre class="src src-R"><span class="org-function-name">anidada</span> <span class="org-ess-assignment">&lt;-</span> <span class="org-ess-keyword">function</span>(x, y){
    xn <span class="org-ess-assignment">&lt;-</span> 2
    yn <span class="org-ess-assignment">&lt;-</span> 3
    <span class="org-function-name">interna</span> <span class="org-ess-assignment">&lt;-</span> <span class="org-ess-keyword">function</span>(x, y)
    {
        sum(x^xn, y^yn)
    }
    print(environment(interna))
    interna(x, y)
}
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R">anidada(1:3, 2:4)
</pre>
</div>

<pre class="example">
&lt;environment: 0x55e3aaf881f8&gt;
[1] 113
</pre>


<div class="org-src-container">
<pre class="src src-R">sum((1:3)^2, (2:4)^3)
</pre>
</div>

<pre class="example">
[1] 113
</pre>
</div>
</div>

<div id="outline-container-org06d0404" class="outline-3">
<h3 id="org06d0404"><span class="section-number-3">2.4</span> Lexical scope: funciones anidadas</h3>
<div class="outline-text-3" id="text-2-4">
<div class="org-src-container">
<pre class="src src-R">xn
</pre>
</div>

<pre class="example">
Error: objeto 'xn' no encontrado
</pre>


<div class="org-src-container">
<pre class="src src-R">yn
</pre>
</div>

<pre class="example">
Error: objeto 'yn' no encontrado
</pre>


<div class="org-src-container">
<pre class="src src-R">interna
</pre>
</div>

<pre class="example">
Error: objeto 'interna' no encontrado
</pre>
</div>
</div>

<div id="outline-container-org4e26cce" class="outline-3">
<h3 id="org4e26cce"><span class="section-number-3">2.5</span> Funciones que devuelven funciones</h3>
<div class="outline-text-3" id="text-2-5">
<div class="org-src-container">
<pre class="src src-R"><span class="org-function-name">constructor</span> <span class="org-ess-assignment">&lt;-</span> <span class="org-ess-keyword">function</span>(m, n){
    <span class="org-ess-keyword">function</span>(x)
    {
        m*x + n
    }
}
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R">myFoo <span class="org-ess-assignment">&lt;-</span> constructor(10, 3)
myFoo
</pre>
</div>

<pre class="example">
function(x)
    {
        m*x + n
    }
&lt;environment: 0x55e3aaf76df0&gt;
</pre>


<div class="org-src-container">
<pre class="src src-R"><span class="org-comment-delimiter">## </span><span class="org-comment">10*5 + 3</span>
myFoo(5)
</pre>
</div>

<pre class="example">
[1] 53
</pre>
</div>
</div>

<div id="outline-container-org66b4541" class="outline-3">
<h3 id="org66b4541"><span class="section-number-3">2.6</span> Funciones que devuelven funciones</h3>
<div class="outline-text-3" id="text-2-6">
<div class="org-src-container">
<pre class="src src-R">class(myFoo)
</pre>
</div>

<pre class="example">
[1] "function"
</pre>


<div class="org-src-container">
<pre class="src src-R">environment(myFoo)
</pre>
</div>

<pre class="example">
&lt;environment: 0x55e3aaf76df0&gt;
</pre>


<div class="org-src-container">
<pre class="src src-R">ls()
</pre>
</div>

<pre class="example">
 [1] "a"               "anidada"         "b"               "constructor"    
 [5] "diamonds"        "fib"             "foo"             "hello"          
 [9] "i"               "lista"           "ll"              "lmFertEduCatAgr"
[13] "m"               "M"               "makeNoise"       "myFoo"          
[17] "myFun"           "power"           "pwrSum"          "suma1"          
[21] "suma10"          "suma2"           "suma3"           "sumProd"        
[25] "sumSq"           "tmp"             "x"               "zz"
</pre>


<div class="org-src-container">
<pre class="src src-R">ls(env = environment(myFoo))
</pre>
</div>

<pre class="example">
[1] "m" "n"
</pre>


<div class="org-src-container">
<pre class="src src-R">get(<span class="org-string">'m'</span>, env = environment(myFoo))
</pre>
</div>

<pre class="example">
[1] 10
</pre>


<div class="org-src-container">
<pre class="src src-R">get(<span class="org-string">'n'</span>, env = environment(myFoo))
</pre>
</div>

<pre class="example">
[1] 3
</pre>
</div>
</div>
</div>

<div id="outline-container-org6bb505b" class="outline-2">
<h2 id="org6bb505b"><span class="section-number-2">3</span> Funciones para ejecutar funciones</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-org180642d" class="outline-3">
<h3 id="org180642d"><span class="section-number-3">3.1</span> <code>lapply</code></h3>
<div class="outline-text-3" id="text-3-1">
<p>
Supongamos que tenemos una lista de objetos, y queremos aplicar a cada elemento la misma función:
</p>
<div class="org-src-container">
<pre class="src src-R">lista <span class="org-ess-assignment">&lt;-</span> list(a = rnorm(100),
              b = runif(100),
              c = rexp(100))
</pre>
</div>

<p>
Podemos resolverlo de forma repetitiva&#x2026;
</p>
<div class="org-src-container">
<pre class="src src-R">sum(lista$a)

sum(lista$b)

sum(lista$c)
</pre>
</div>

<pre class="example">
[1] 8.489702
[1] 50.83217
[1] 107.1475
</pre>


<p>
O mejor con <code>lapply</code> (lista + función):
</p>
<div class="org-src-container">
<pre class="src src-R">lapply(lista, sum)
</pre>
</div>

<pre class="example">
$a
[1] 8.489702

$b
[1] 50.83217

$c
[1] 107.1475
</pre>
</div>
</div>

<div id="outline-container-orgd76acde" class="outline-3">
<h3 id="orgd76acde"><span class="section-number-3">3.2</span> <code>do.call</code></h3>
<div class="outline-text-3" id="text-3-2">
<p>
Supongamos que queremos usar los elementos de la lista como argumentos de una función.
</p>

<p>
Resolvemos de forma directa:
</p>
<div class="org-src-container">
<pre class="src src-R">sum(lista$a, lista$b, lista$c)
</pre>
</div>

<pre class="example">
[1] 166.4693
</pre>


<p>
Mejoramos <i>un poco</i> con <code>with</code>:
</p>
<div class="org-src-container">
<pre class="src src-R">with(lista, sum(a, b, c))
</pre>
</div>

<pre class="example">
[1] 166.4693
</pre>


<p>
La forma recomendable es mediante <code>do.call</code> (función + lista)
</p>
<div class="org-src-container">
<pre class="src src-R">do.call(sum, lista)
</pre>
</div>

<pre class="example">
[1] 166.4693
</pre>
</div>
</div>

<div id="outline-container-orgf74c6d0" class="outline-3">
<h3 id="orgf74c6d0"><span class="section-number-3">3.3</span> <code>do.call</code></h3>
<div class="outline-text-3" id="text-3-3">
<p>
Se emplea frecuentemente para adecuar el resultado de <code>lapply</code> (entrega una lista):
</p>
<div class="org-src-container">
<pre class="src src-R">  x <span class="org-ess-assignment">&lt;-</span> rnorm(5)
  ll <span class="org-ess-assignment">&lt;-</span> lapply(1:5, <span class="org-ess-keyword">function</span>(i)x^i)
  do.call(rbind, ll)
</pre>
</div>

<pre class="example">
            [,1]      [,2]       [,3]      [,4]      [,5]
[1,] -0.55075982 -1.361554  -1.608803  2.307038 0.6017228
[2,]  0.30333638  1.853829   2.588246  5.322423 0.3620703
[3,] -0.16706549 -2.524089  -4.163977 12.279030 0.2178660
[4,]  0.09201296  3.436683   6.699018 28.328184 0.1310949
[5,] -0.05067704 -4.679229 -10.777397 65.354187 0.0788828
</pre>
</div>
</div>

<div id="outline-container-org9b13f81" class="outline-3">
<h3 id="org9b13f81"><span class="section-number-3">3.4</span> <code>Reduce</code></h3>
<div class="outline-text-3" id="text-3-4">
<p>
Combina sucesivamente los elementos de un objeto aplicando una función binaria
</p>
<div class="org-src-container">
<pre class="src src-R"><span class="org-comment-delimiter">## </span><span class="org-comment">(((1+2)+3)+4)+5</span>
Reduce(<span class="org-string">'+'</span>, 1:5)
</pre>
</div>

<pre class="example">
[1] 15
</pre>
</div>
</div>

<div id="outline-container-org45b57ba" class="outline-3">
<h3 id="org45b57ba"><span class="section-number-3">3.5</span> <code>Reduce</code></h3>
<div class="outline-text-3" id="text-3-5">
<div class="org-src-container">
<pre class="src src-R"><span class="org-comment-delimiter">## </span><span class="org-comment">(((1/2)/3)/4)/5</span>
Reduce(<span class="org-string">'/'</span>, 1:5)
</pre>
</div>

<pre class="example">
[1] 0.008333333
</pre>


<div class="org-src-container">
<pre class="src src-R"><span class="org-function-name">foo</span> <span class="org-ess-assignment">&lt;-</span> <span class="org-ess-keyword">function</span>(u, v)u + 1 /v
Reduce(foo, c(3, 7, 15, 1, 292))
<span class="org-comment-delimiter">## </span><span class="org-comment">equivalente a</span>
<span class="org-comment-delimiter">## </span><span class="org-comment">foo(foo(foo(foo(3, 7), 15), 1), 292)</span>
</pre>
</div>

<pre class="example">
[1] 4.212948
</pre>


<div class="org-src-container">
<pre class="src src-R">Reduce(foo, c(3, 7, 15, 1, 292), right=<span class="org-ess-constant">TRUE</span>)
<span class="org-comment-delimiter">## </span><span class="org-comment">equivalente a</span>
<span class="org-comment-delimiter">## </span><span class="org-comment">foo(3, foo(7, foo(15, foo(1, 292))))</span>
</pre>
</div>

<pre class="example">
[1] 3.141593
</pre>
</div>
</div>

<div id="outline-container-org7bbfcc3" class="outline-3">
<h3 id="org7bbfcc3"><span class="section-number-3">3.6</span> Funciones recursivas</h3>
<div class="outline-text-3" id="text-3-6">
<p>
Ejemplo: <a href="http://en.wikibooks.org/wiki/R_Programming/Working_with_functions#Functions_as_Objects">Serie de Fibonnaci</a>
</p>
<div class="org-src-container">
<pre class="src src-R"><span class="org-function-name">fib</span> <span class="org-ess-assignment">&lt;-</span> <span class="org-ess-keyword">function</span>(n){
    <span class="org-ess-keyword">if</span> (n&gt;2) {
        c(fib(n-1),
          sum(tail(fib(n-1),2)))
    } <span class="org-ess-keyword">else</span> <span class="org-ess-keyword">if</span> (n&gt;=0) rep(1,n)
}
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R">fib(10)
</pre>
</div>

<pre class="example">
[1]  1  1  2  3  5  8 13 21 34 55
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb03effc" class="outline-2">
<h2 id="orgb03effc"><span class="section-number-2">4</span> Debug</h2>
<div class="outline-text-2" id="text-4">
</div>
<div id="outline-container-org961f247" class="outline-3">
<h3 id="org961f247"><span class="section-number-3">4.1</span> Post-mortem: <code>traceback</code></h3>
<div class="outline-text-3" id="text-4-1">
<div class="org-src-container">
<pre class="src src-R"><span class="org-function-name">sumSq</span> <span class="org-ess-assignment">&lt;-</span> <span class="org-ess-keyword">function</span>(x, ...)
    sum(x ^ 2, ...)

<span class="org-function-name">sumProd</span> <span class="org-ess-assignment">&lt;-</span> <span class="org-ess-keyword">function</span>(x, y, ...){
    xs <span class="org-ess-assignment">&lt;-</span> sumSq(x, ...)
    ys <span class="org-ess-assignment">&lt;-</span> sumSq(y, ...)
    xs * ys
}
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R">sumProd(rnorm(10), runif(10))
</pre>
</div>

<pre class="example">
[1] 15.84303
</pre>


<div class="org-src-container">
<pre class="src src-R">sumProd(rnorm(10), letters[1:10])
</pre>
</div>

<pre class="example">
Error in x^2 : argumento no-numérico para operador binario
</pre>


<div class="org-src-container">
<pre class="src src-R">traceback()
</pre>
</div>

<pre class="example">
2: sumSq(y, ...) at #3
1: sumProd(rnorm(10), letters[1:10])
</pre>
</div>
</div>

<div id="outline-container-org6395680" class="outline-3">
<h3 id="org6395680"><span class="section-number-3">4.2</span> Analizar antes de que ocurra: <code>debug</code></h3>
<div class="outline-text-3" id="text-4-2">
<p>
<code>debug</code> activa la ejecución paso a paso de una función:
</p>
<div class="org-src-container">
<pre class="src src-R">debug(sumProd)
</pre>
</div>

<ul class="org-ul">
<li>Cada vez que se llame a la función, su cuerpo se ejecuta línea a línea y los resultados de cada paso pueden ser inspeccionados.</li>
<li>Los comandos disponibles son:
<ul class="org-ul">
<li><code>n</code> o intro: avanzar un paso.</li>
<li><code>c</code>: continua hasta el final del contexto actual (por ejemplo,
terminar un bucle).</li>
<li><code>where</code>: entrega la lista de todas las llamadas activas.</li>
<li><code>Q</code>: termina la inspección y vuelve al nivel superior.</li>
</ul></li>
<li>Para desactivar el análisis:</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">undebug(sumProd)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgeedc65b" class="outline-3">
<h3 id="orgeedc65b"><span class="section-number-3">4.3</span> Analizar antes de que ocurra: <code>trace</code></h3>
<div class="outline-text-3" id="text-4-3">
<ul class="org-ul">
<li><code>trace</code> permite mayor control que <code>debug</code></li>
</ul>
<div class="org-src-container">
<pre class="src src-R">trace(sumProd, tracer=browser, exit=browser)
</pre>
</div>

<pre class="example">
[1] "sumProd"
</pre>


<ul class="org-ul">
<li>La función queda modificada</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">sumProd
</pre>
</div>

<pre class="example">
Object with tracing code, class "functionWithTrace"
Original definition: 
function(x, y, ...){
    xs &lt;- sumSq(x, ...)
    ys &lt;- sumSq(y, ...)
    xs * ys
}
&lt;bytecode: 0x55e3a7594f68&gt;

## (to see the tracing code, look at body(object))
</pre>

<div class="org-src-container">
<pre class="src src-R">body(sumProd)
</pre>
</div>

<pre class="example">
{
    on.exit(.doTrace(browser(), "on exit"))
    {
        .doTrace(browser(), "on entry")
        {
            xs &lt;- sumSq(x, ...)
            ys &lt;- sumSq(y, ...)
            xs * ys
        }
    }
}
</pre>
</div>
</div>

<div id="outline-container-orgc5c12ae" class="outline-3">
<h3 id="orgc5c12ae"><span class="section-number-3">4.4</span> Analizar antes de que ocurra: <code>trace</code></h3>
<div class="outline-text-3" id="text-4-4">
<ul class="org-ul">
<li>Los comandos <code>n</code> y <code>c</code> cambian respecto a <code>debug</code>:
<ul class="org-ul">
<li><code>c</code> o intro: avanzar un paso.</li>
<li><code>n</code>: continua hasta el final del contexto actual (por ejemplo,
terminar un bucle).</li>
</ul></li>
<li>Para desactivar</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">untrace(sumProd)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb0f300a" class="outline-3">
<h3 id="orgb0f300a"><span class="section-number-3">4.5</span> Más recursos</h3>
<div class="outline-text-3" id="text-4-5">
<ul class="org-ul">
<li>Debugging en RStudio
<ul class="org-ul">
<li><a href="https://support.rstudio.com/hc/en-us/articles/205612627-Debugging-with-RStudio">Artículo</a></li>
<li><a href="https://vimeo.com/97831988">Vídeo</a></li>
</ul></li>
<li><a href="http://adv-r.had.co.nz/Exceptions-Debugging.html"><i>Debugging</i> explicado por H. Wickham</a></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org266291d" class="outline-2">
<h2 id="org266291d"><span class="section-number-2">5</span> Profiling</h2>
<div class="outline-text-2" id="text-5">
</div>
<div id="outline-container-org57c800a" class="outline-3">
<h3 id="org57c800a"><span class="section-number-3">5.1</span> ¿Cuánto tarda mi función? <code>system.time</code></h3>
<div class="outline-text-3" id="text-5-1">
<p>
Defino una función que rellena una matriz de 10<sup>6</sup> filas y <code>n</code> columnas con una distribución normal:
</p>
<div class="org-src-container">
<pre class="src src-R"><span class="org-function-name">makeNoise</span> <span class="org-ess-assignment">&lt;-</span> <span class="org-ess-keyword">function</span>(n){
    sapply(seq_len(n), <span class="org-ess-keyword">function</span>(i) rnorm(1e6))
}
</pre>
</div>

<div class="org-src-container">
<pre class="src src-R">M <span class="org-ess-assignment">&lt;-</span> makeNoise(100)
summary(M)
</pre>
</div>

<pre class="example">
       V1                  V2                  V3           
 Min.   :-4.744061   Min.   :-4.614207   Min.   :-4.840808  
 1st Qu.:-0.673220   1st Qu.:-0.674554   1st Qu.:-0.673997  
 Median : 0.001441   Median :-0.000626   Median : 0.001366  
 Mean   : 0.000868   Mean   :-0.000324   Mean   : 0.000544  
 3rd Qu.: 0.675404   3rd Qu.: 0.673979   3rd Qu.: 0.675865  
 Max.   : 5.057772   Max.   : 5.467457   Max.   : 4.556630  
       V4                  V5                  V6           
 Min.   :-4.855362   Min.   :-4.625621   Min.   :-4.687500  
 1st Qu.:-0.672866   1st Qu.:-0.673310   1st Qu.:-0.674329  
 Median : 0.001635   Median :-0.000994   Median : 0.001183  
 Mean   : 0.001151   Mean   :-0.000773   Mean   : 0.000159  
 3rd Qu.: 0.675017   3rd Qu.: 0.674156   3rd Qu.: 0.675346  
 Max.   : 4.994363   Max.   : 5.276039   Max.   : 4.726836  
       V7                  V8                  V9           
 Min.   :-4.698333   Min.   :-5.071905   Min.   :-4.984151  
 1st Qu.:-0.675398   1st Qu.:-0.673706   1st Qu.:-0.673066  
 Median :-0.001933   Median :-0.001020   Median : 0.002034  
 Mean   :-0.001188   Mean   :-0.001321   Mean   : 0.001885  
 3rd Qu.: 0.674389   3rd Qu.: 0.671993   3rd Qu.: 0.677920  
 Max.   : 4.749034   Max.   : 4.996226   Max.   : 4.437860  
      V10                 V11                 V12           
 Min.   :-5.464344   Min.   :-4.674910   Min.   :-4.961835  
 1st Qu.:-0.674413   1st Qu.:-0.674086   1st Qu.:-0.676861  
 Median : 0.000768   Median : 0.001002   Median :-0.000207  
 Mean   : 0.001527   Mean   : 0.000033   Mean   :-0.001468  
 3rd Qu.: 0.677143   3rd Qu.: 0.674414   3rd Qu.: 0.673470  
 Max.   : 4.699352   Max.   : 4.803944   Max.   : 4.503655  
      V13                 V14                 V15           
 Min.   :-4.951352   Min.   :-5.042427   Min.   :-4.741670  
 1st Qu.:-0.675560   1st Qu.:-0.676030   1st Qu.:-0.674961  
 Median :-0.000590   Median :-0.000700   Median : 0.001081  
 Mean   :-0.000918   Mean   :-0.000437   Mean   : 0.001055  
 3rd Qu.: 0.674159   3rd Qu.: 0.674286   3rd Qu.: 0.676888  
 Max.   : 4.752366   Max.   : 4.816343   Max.   : 4.741994  
      V16                 V17                 V18           
 Min.   :-5.166864   Min.   :-5.046180   Min.   :-5.062963  
 1st Qu.:-0.674267   1st Qu.:-0.672999   1st Qu.:-0.675790  
 Median : 0.001911   Median : 0.000749   Median :-0.000232  
 Mean   : 0.000361   Mean   : 0.000615   Mean   :-0.000860  
 3rd Qu.: 0.674753   3rd Qu.: 0.675715   3rd Qu.: 0.673213  
 Max.   : 5.095021   Max.   : 4.762989   Max.   : 4.991325  
      V19                 V20                 V21           
 Min.   :-4.535959   Min.   :-4.830982   Min.   :-5.194490  
 1st Qu.:-0.674487   1st Qu.:-0.675513   1st Qu.:-0.673294  
 Median :-0.001058   Median :-0.000589   Median :-0.000784  
 Mean   :-0.000349   Mean   :-0.001410   Mean   :-0.000154  
 3rd Qu.: 0.674239   3rd Qu.: 0.674354   3rd Qu.: 0.674034  
 Max.   : 5.219982   Max.   : 4.514762   Max.   : 5.095876  
      V22                 V23                 V24           
 Min.   :-4.861253   Min.   :-4.708703   Min.   :-4.898835  
 1st Qu.:-0.674713   1st Qu.:-0.677151   1st Qu.:-0.674264  
 Median :-0.000019   Median :-0.001099   Median :-0.001043  
 Mean   :-0.000167   Mean   :-0.000064   Mean   :-0.000528  
 3rd Qu.: 0.675440   3rd Qu.: 0.675951   3rd Qu.: 0.672770  
 Max.   : 4.987770   Max.   : 4.765466   Max.   : 4.972243  
      V25                 V26                 V27           
 Min.   :-4.758664   Min.   :-4.656429   Min.   :-4.839906  
 1st Qu.:-0.673880   1st Qu.:-0.673873   1st Qu.:-0.676508  
 Median :-0.001657   Median : 0.000630   Median :-0.001681  
 Mean   :-0.000519   Mean   : 0.001395   Mean   :-0.001532  
 3rd Qu.: 0.674320   3rd Qu.: 0.675536   3rd Qu.: 0.672955  
 Max.   : 4.599153   Max.   : 5.083516   Max.   : 4.895979  
      V28                 V29                 V30           
 Min.   :-5.045172   Min.   :-4.500525   Min.   :-4.627149  
 1st Qu.:-0.673704   1st Qu.:-0.673522   1st Qu.:-0.674557  
 Median : 0.000679   Median : 0.000236   Median :-0.000091  
 Mean   : 0.000209   Mean   : 0.000081   Mean   :-0.000503  
 3rd Qu.: 0.673346   3rd Qu.: 0.673692   3rd Qu.: 0.674137  
 Max.   : 4.741277   Max.   : 4.758619   Max.   : 4.814824  
      V31                 V32                 V33           
 Min.   :-4.900488   Min.   :-4.834541   Min.   :-5.125517  
 1st Qu.:-0.671665   1st Qu.:-0.674335   1st Qu.:-0.674215  
 Median :-0.000021   Median : 0.000292   Median : 0.001781  
 Mean   : 0.000206   Mean   : 0.000080   Mean   : 0.001316  
 3rd Qu.: 0.671988   3rd Qu.: 0.673660   3rd Qu.: 0.676290  
 Max.   : 5.262798   Max.   : 4.810985   Max.   : 4.978200  
      V34                 V35                 V36           
 Min.   :-4.863579   Min.   :-5.110182   Min.   :-4.652401  
 1st Qu.:-0.673607   1st Qu.:-0.674679   1st Qu.:-0.672864  
 Median :-0.001424   Median : 0.000463   Median :-0.000378  
 Mean   :-0.000388   Mean   :-0.000163   Mean   : 0.000650  
 3rd Qu.: 0.673129   3rd Qu.: 0.673420   3rd Qu.: 0.674517  
 Max.   : 4.644706   Max.   : 5.568015   Max.   : 5.373416  
      V37                 V38                 V39           
 Min.   :-4.788255   Min.   :-4.522164   Min.   :-4.856823  
 1st Qu.:-0.671514   1st Qu.:-0.676621   1st Qu.:-0.673515  
 Median :-0.000685   Median :-0.000826   Median : 0.000442  
 Mean   : 0.000590   Mean   :-0.001633   Mean   : 0.001233  
 3rd Qu.: 0.673976   3rd Qu.: 0.673365   3rd Qu.: 0.676035  
 Max.   : 4.664485   Max.   : 4.910088   Max.   : 4.840348  
      V40                 V41                 V42           
 Min.   :-4.794268   Min.   :-4.706101   Min.   :-4.647193  
 1st Qu.:-0.675184   1st Qu.:-0.676055   1st Qu.:-0.676240  
 Median :-0.000083   Median : 0.000618   Median :-0.002475  
 Mean   :-0.000090   Mean   : 0.000311   Mean   :-0.001760  
 3rd Qu.: 0.675757   3rd Qu.: 0.675044   3rd Qu.: 0.673705  
 Max.   : 4.726223   Max.   : 4.675562   Max.   : 4.956956  
      V43                 V44                 V45           
 Min.   :-4.980195   Min.   :-4.564547   Min.   :-4.986746  
 1st Qu.:-0.673845   1st Qu.:-0.673398   1st Qu.:-0.673359  
 Median :-0.000175   Median : 0.001559   Median : 0.001026  
 Mean   :-0.000213   Mean   : 0.001462   Mean   : 0.000706  
 3rd Qu.: 0.673135   3rd Qu.: 0.676034   3rd Qu.: 0.675391  
 Max.   : 4.972574   Max.   : 5.080799   Max.   : 4.853049  
      V46                 V47                 V48           
 Min.   :-4.811445   Min.   :-4.897435   Min.   :-5.089017  
 1st Qu.:-0.673674   1st Qu.:-0.673677   1st Qu.:-0.675418  
 Median : 0.000595   Median : 0.000852   Median : 0.002805  
 Mean   : 0.000173   Mean   : 0.000949   Mean   : 0.001862  
 3rd Qu.: 0.675212   3rd Qu.: 0.676273   3rd Qu.: 0.678313  
 Max.   : 5.418014   Max.   : 4.547664   Max.   : 4.822002  
      V49                 V50                 V51           
 Min.   :-4.795779   Min.   :-4.942669   Min.   :-4.752360  
 1st Qu.:-0.677541   1st Qu.:-0.676033   1st Qu.:-0.675310  
 Median :-0.002189   Median :-0.000472   Median : 0.000021  
 Mean   :-0.000700   Mean   :-0.001488   Mean   : 0.000664  
 3rd Qu.: 0.675472   3rd Qu.: 0.674617   3rd Qu.: 0.675662  
 Max.   : 5.413333   Max.   : 5.305668   Max.   : 4.765685  
      V52                 V53                 V54           
 Min.   :-5.250422   Min.   :-5.319640   Min.   :-5.009351  
 1st Qu.:-0.673668   1st Qu.:-0.675474   1st Qu.:-0.671939  
 Median : 0.002390   Median :-0.002539   Median : 0.000705  
 Mean   : 0.001157   Mean   :-0.001871   Mean   : 0.000144  
 3rd Qu.: 0.675155   3rd Qu.: 0.672826   3rd Qu.: 0.673715  
 Max.   : 5.114749   Max.   : 4.627143   Max.   : 5.906985  
      V55                 V56                 V57           
 Min.   :-4.701626   Min.   :-4.602506   Min.   :-4.956234  
 1st Qu.:-0.672497   1st Qu.:-0.675696   1st Qu.:-0.673656  
 Median : 0.002310   Median :-0.000897   Median : 0.000228  
 Mean   : 0.002287   Mean   :-0.000308   Mean   : 0.000893  
 3rd Qu.: 0.676015   3rd Qu.: 0.672925   3rd Qu.: 0.674874  
 Max.   : 4.647982   Max.   : 5.091073   Max.   : 4.892341  
      V58                 V59                 V60           
 Min.   :-4.780485   Min.   :-4.516412   Min.   :-4.677366  
 1st Qu.:-0.672726   1st Qu.:-0.673791   1st Qu.:-0.673906  
 Median : 0.001126   Median : 0.001473   Median : 0.000126  
 Mean   : 0.001778   Mean   : 0.001180   Mean   : 0.000226  
 3rd Qu.: 0.675519   3rd Qu.: 0.674614   3rd Qu.: 0.673868  
 Max.   : 4.753521   Max.   : 5.209606   Max.   : 4.905310  
      V61                 V62                 V63           
 Min.   :-4.656071   Min.   :-4.866517   Min.   :-5.253979  
 1st Qu.:-0.674548   1st Qu.:-0.675739   1st Qu.:-0.674271  
 Median : 0.000202   Median :-0.000619   Median :-0.000227  
 Mean   : 0.001039   Mean   :-0.000317   Mean   : 0.000325  
 3rd Qu.: 0.676381   3rd Qu.: 0.673709   3rd Qu.: 0.675609  
 Max.   : 4.788622   Max.   : 4.644802   Max.   : 4.712988  
      V64                 V65                 V66           
 Min.   :-4.857339   Min.   :-5.040047   Min.   :-4.984635  
 1st Qu.:-0.673994   1st Qu.:-0.671617   1st Qu.:-0.674770  
 Median :-0.000723   Median : 0.002019   Median :-0.001198  
 Mean   : 0.000123   Mean   : 0.002235   Mean   :-0.001287  
 3rd Qu.: 0.673585   3rd Qu.: 0.675603   3rd Qu.: 0.672837  
 Max.   : 4.513948   Max.   : 4.865335   Max.   : 4.692417  
      V67                 V68                 V69           
 Min.   :-4.709750   Min.   :-4.862034   Min.   :-4.695578  
 1st Qu.:-0.674452   1st Qu.:-0.674765   1st Qu.:-0.673811  
 Median :-0.000064   Median :-0.001680   Median : 0.000754  
 Mean   :-0.000837   Mean   : 0.000497   Mean   :-0.000202  
 3rd Qu.: 0.672007   3rd Qu.: 0.674681   3rd Qu.: 0.673535  
 Max.   : 4.702295   Max.   : 5.061991   Max.   : 4.486999  
      V70                 V71                 V72           
 Min.   :-4.645594   Min.   :-4.798209   Min.   :-4.696798  
 1st Qu.:-0.673368   1st Qu.:-0.671926   1st Qu.:-0.673307  
 Median : 0.000637   Median : 0.001784   Median : 0.000217  
 Mean   : 0.000504   Mean   : 0.001691   Mean   : 0.000045  
 3rd Qu.: 0.674369   3rd Qu.: 0.674585   3rd Qu.: 0.673408  
 Max.   : 4.702703   Max.   : 4.700611   Max.   : 4.769359  
      V73                 V74                 V75           
 Min.   :-4.644225   Min.   :-4.604387   Min.   :-4.531087  
 1st Qu.:-0.673305   1st Qu.:-0.673577   1st Qu.:-0.675646  
 Median : 0.002551   Median :-0.000225   Median :-0.000247  
 Mean   : 0.001188   Mean   : 0.000358   Mean   :-0.000396  
 3rd Qu.: 0.675703   3rd Qu.: 0.676519   3rd Qu.: 0.675457  
 Max.   : 4.641535   Max.   : 4.982708   Max.   : 4.933764  
      V76                 V77                 V78           
 Min.   :-5.019913   Min.   :-4.983896   Min.   :-4.792313  
 1st Qu.:-0.674658   1st Qu.:-0.674713   1st Qu.:-0.675432  
 Median : 0.000529   Median :-0.001188   Median :-0.002025  
 Mean   : 0.000118   Mean   :-0.001179   Mean   :-0.002125  
 3rd Qu.: 0.674640   3rd Qu.: 0.671751   3rd Qu.: 0.671820  
 Max.   : 4.474925   Max.   : 5.073182   Max.   : 4.761905  
      V79                 V80                 V81           
 Min.   :-4.781387   Min.   :-5.128899   Min.   :-4.623971  
 1st Qu.:-0.674538   1st Qu.:-0.674753   1st Qu.:-0.671304  
 Median : 0.000531   Median : 0.000573   Median : 0.001618  
 Mean   : 0.000901   Mean   : 0.000864   Mean   : 0.002157  
 3rd Qu.: 0.674618   3rd Qu.: 0.675071   3rd Qu.: 0.675377  
 Max.   : 4.812967   Max.   : 4.796416   Max.   : 4.764486  
      V82                 V83                 V84           
 Min.   :-4.825972   Min.   :-5.466961   Min.   :-4.838455  
 1st Qu.:-0.674957   1st Qu.:-0.675813   1st Qu.:-0.675697  
 Median :-0.000413   Median :-0.001118   Median :-0.001710  
 Mean   :-0.000342   Mean   :-0.000653   Mean   :-0.001085  
 3rd Qu.: 0.674760   3rd Qu.: 0.675361   3rd Qu.: 0.673761  
 Max.   : 4.700011   Max.   : 4.929093   Max.   : 5.111040  
      V85                 V86                 V87           
 Min.   :-4.669761   Min.   :-4.799953   Min.   :-4.981196  
 1st Qu.:-0.671861   1st Qu.:-0.672830   1st Qu.:-0.674951  
 Median : 0.001851   Median : 0.000320   Median : 0.000835  
 Mean   : 0.002005   Mean   :-0.000123   Mean   :-0.000153  
 3rd Qu.: 0.676978   3rd Qu.: 0.675136   3rd Qu.: 0.672333  
 Max.   : 4.774587   Max.   : 4.511883   Max.   : 4.748976  
      V88                 V89                 V90           
 Min.   :-5.063680   Min.   :-4.622325   Min.   :-4.890907  
 1st Qu.:-0.672702   1st Qu.:-0.674058   1st Qu.:-0.671872  
 Median : 0.002021   Median :-0.001122   Median : 0.001670  
 Mean   : 0.001157   Mean   :-0.001943   Mean   : 0.001123  
 3rd Qu.: 0.675405   3rd Qu.: 0.671314   3rd Qu.: 0.673844  
 Max.   : 5.117869   Max.   : 4.713761   Max.   : 4.765657  
      V91                 V92                 V93           
 Min.   :-4.869539   Min.   :-4.984608   Min.   :-5.188314  
 1st Qu.:-0.677259   1st Qu.:-0.675243   1st Qu.:-0.673718  
 Median :-0.002971   Median : 0.000133   Median : 0.000354  
 Mean   :-0.001765   Mean   :-0.000156   Mean   : 0.000616  
 3rd Qu.: 0.673569   3rd Qu.: 0.674890   3rd Qu.: 0.674229  
 Max.   : 4.756104   Max.   : 4.664630   Max.   : 4.858454  
      V94                 V95                 V96           
 Min.   :-5.281237   Min.   :-4.659431   Min.   :-4.715716  
 1st Qu.:-0.673833   1st Qu.:-0.675240   1st Qu.:-0.675549  
 Median : 0.001799   Median :-0.000032   Median :-0.001451  
 Mean   : 0.000666   Mean   :-0.000457   Mean   :-0.001837  
 3rd Qu.: 0.675970   3rd Qu.: 0.675593   3rd Qu.: 0.671377  
 Max.   : 5.213899   Max.   : 4.563757   Max.   : 5.224793  
      V97                 V98                 V99           
 Min.   :-4.889216   Min.   :-4.846267   Min.   :-5.808840  
 1st Qu.:-0.676169   1st Qu.:-0.676768   1st Qu.:-0.674442  
 Median :-0.001597   Median :-0.001276   Median : 0.000793  
 Mean   :-0.001286   Mean   :-0.001388   Mean   : 0.000001  
 3rd Qu.: 0.673154   3rd Qu.: 0.673555   3rd Qu.: 0.674289  
 Max.   : 4.733302   Max.   : 4.695957   Max.   : 5.006915  
      V100          
 Min.   :-4.927842  
 1st Qu.:-0.676038  
 Median : 0.000128  
 Mean   : 0.000303  
 3rd Qu.: 0.675637  
 Max.   : 4.437032
</pre>
</div>
</div>

<div id="outline-container-org6e491b6" class="outline-3">
<h3 id="org6e491b6"><span class="section-number-3">5.2</span> Diferentes formas de sumar</h3>
<div class="outline-text-3" id="text-5-2">
<p>
<code>system.time</code> mide el tiempo de CPU que consume un código<sup><a id="fnr.1" class="footref" href="#fn.1">1</a></sup>.
</p>

<div class="org-src-container">
<pre class="src src-R">system.time({
    suma1 <span class="org-ess-assignment">&lt;-</span> numeric(1e6)
    <span class="org-ess-keyword">for</span>(i <span class="org-ess-keyword">in</span> 1:1e6) suma1[i] <span class="org-ess-assignment">&lt;-</span> sum(M[i,])
})
</pre>
</div>

<pre class="example">
 user  system elapsed 
1.664   0.001   1.658
</pre>


<div class="org-src-container">
<pre class="src src-R">system.time(suma2 <span class="org-ess-assignment">&lt;-</span> apply(M, 1, sum))
</pre>
</div>

<pre class="example">
 user  system elapsed 
2.391   0.150   2.528
</pre>


<div class="org-src-container">
<pre class="src src-R">system.time(suma3 <span class="org-ess-assignment">&lt;-</span> rowSums(M))
</pre>
</div>

<pre class="example">
 user  system elapsed 
0.313   0.000   0.311
</pre>
</div>
</div>


<div id="outline-container-org0cbc7bd" class="outline-3">
<h3 id="org0cbc7bd"><span class="section-number-3">5.3</span> ¿Cuánto tarda cada parte de mi función?: <code>Rprof</code></h3>
<div class="outline-text-3" id="text-5-3">
<ul class="org-ul">
<li>Usaremos un fichero temporal</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">tmp <span class="org-ess-assignment">&lt;-</span> tempfile()
</pre>
</div>

<ul class="org-ul">
<li>Activamos la toma de información</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">Rprof(tmp)
</pre>
</div>

<ul class="org-ul">
<li>Ejecutamos el código a analizar</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">suma1 <span class="org-ess-assignment">&lt;-</span> numeric(1e6)
<span class="org-ess-keyword">for</span>(i <span class="org-ess-keyword">in</span> 1:1e6) suma1[i] <span class="org-ess-assignment">&lt;-</span> sum(M[i,])

suma2 <span class="org-ess-assignment">&lt;-</span> apply(M, 1, FUN = sum)

suma3 <span class="org-ess-assignment">&lt;-</span> rowSums(M)
</pre>
</div>
</div>
</div>

<div id="outline-container-org8b61da5" class="outline-3">
<h3 id="org8b61da5"><span class="section-number-3">5.4</span> ¿Cuánto tarda cada parte de mi función?: <code>Rprof</code></h3>
<div class="outline-text-3" id="text-5-4">
<ul class="org-ul">
<li>Paramos el análisis</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">Rprof()
</pre>
</div>

<ul class="org-ul">
<li>Extraemos el resumen</li>
</ul>
<div class="org-src-container">
<pre class="src src-R">summaryRprof(tmp)
</pre>
</div>

<pre class="example">
$by.self
                self.time self.pct total.time total.pct
"apply"              1.46    45.06       2.76     85.19
"aperm.default"      0.84    25.93       0.84     25.93
"FUN"                0.44    13.58       0.44     13.58
"rowSums"            0.30     9.26       0.30      9.26
"sum"                0.18     5.56       0.18      5.56
"unlist"             0.02     0.62       0.02      0.62

$by.total
                total.time total.pct self.time self.pct
"apply"               2.76     85.19      1.46    45.06
"aperm.default"       0.84     25.93      0.84    25.93
"aperm"               0.84     25.93      0.00     0.00
"FUN"                 0.44     13.58      0.44    13.58
"rowSums"             0.30      9.26      0.30     9.26
"sum"                 0.18      5.56      0.18     5.56
"unlist"              0.02      0.62      0.02     0.62

$sample.interval
[1] 0.02

$sampling.time
[1] 3.24
</pre>
</div>
</div>
</div>
<div id="footnotes">
<h2 class="footnotes">Nota al pie de p&aacute;gina: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" class="footnum" href="#fnr.1">1</a></sup> <div class="footpara"><p class="footpara">
Para entender la diferencia entre <code>user</code> y <code>system</code> véase explicación <a href="http://r.789695.n4.nabble.com/Meaning-of-proc-time-tp2303263p2306691.html">aquí</a>. 
</p></div></div>


</div>
</div></div>
<div id="postamble" class="status">
<p class="author">Autor: Oscar Perpiñán Lamigueiro  <a href="http://oscarperpinan.github.io">http://oscarperpinan.github.io</a></p>
<p class="date">Created: 2019-05-22 mié 20:23</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
